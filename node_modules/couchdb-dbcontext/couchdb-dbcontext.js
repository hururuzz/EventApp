"use strict"

var request = require("request");

this.getData = function(dbUrl, table, id, callBack){
    return request({
        method: "GET",
        url: dbUrl + table + id,
        json: true
    }, callBack);
}

var putData = function(dbUrl, table, id, data, callBack){
    return request({
        method: "PUT",
        url: dbUrl + table + id,
        json: true,
        body: data
    }, callBack);
}

this.saveData = function(dbUrl, table, id, data, callBack){
    this.getData(dbUrl, table, id, function(error, response, body){
        if (data._rev === response.body._rev){
                putData(dbUrl, table, id, data, function(error, response, body){
                    if (error){
                        console.log(error);
                        return false;
                    }
                    else if (body.error){
                        console.log(body.error);
                        return false;
                    }
                    else {
                        console.log("The data has been saved");
                        return true;
                    }
            });
        } else {
            return false;
        }
    });
}